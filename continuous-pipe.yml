tasks:
  ##################################
  # Second level dependency images #
  ##################################
  second_level_dependency_images:
    build:
      services:
        ubuntu:
          image: quay.io/continuouspipe/ubuntu16.04
          tag: latest

  #################################
  # First level dependency images #
  #################################
  first_level_dependency_images:
    build:
      services:
        php70_apache:
          image: quay.io/continuouspipe/php7-apache
          tag: latest
          environment:
            - name: PHP_VERSION
              value: '7.0'

  ###########################
  # No dependency images    #
  ###########################
  no_dependency_images:
    build:
      services:
        drupal_php70_apache:
          image: quay.io/continuouspipe/drupal-php7-apache
          tag: test

notifications:
  slack_failure_notification:
    slack:
      webhook_url: ${SLACK_WEBHOOK_URL}
    when:
      - failure

filter: code_reference.branch in ["master", "feature/fix-drupal-image-build"]
